# -*- coding: utf-8 -*-
"""
Created on Thu Jul 11 13:49:38 2024

@author: bsms9zh8
"""

import psychopy
import os.path as op
from psychopy import event, visual, gui, core
from statistics import mean


from intart_functions import sendParallelTrigger, readParallelTrigger
from create_stimuli_final import create_experimental_stimuli
from experiment_variables_function import experiment_variables
from save_file_modification_function import save_file_modification
from instructions_function import instructions
from experiment_block_function import experiment_block 
from save_experimental_block_function import save_experimental_block

### GATHERING PARTICIPANT INFO ### 

participant_info = {'Subject ID': '', 'Age': '', 'Sex': ['M', 'F'],
                    'Order': '', 'Counterbalance group': '', 'Random seed': ''}

myDlg = gui.DlgFromDict(participant_info, title="Sam gaze experiment")

if not myDlg.OK:
    core.quit()
    
order = int(participant_info['Order']) # this is for the order in which systole/diastole blocks are presented (two possible orders, 1 and 2)
subject_id = str(participant_info['Subject ID'])
random_seed = int(participant_info['Random seed'])
age = str(participant_info['Age'])
sex = str(participant_info['Sex'])
counterbalance_group = int(participant_info['Counterbalance group']) # and this is for the order in which the faces are presented (6 possible groups) 

win = visual.Window(color = '#000000', fullscr = True, monitor="testMonitor", units="pix")
win.mouseVisible = False

### FUNCTION TO CREATE SOME VARIABLES ### 

pport_address_spike, trigger_code_spike, experiment_clock, countdown, fr, one_frame, inc, num_ticks, tick_length, spacing, task_order_1, task_order_2, rep_length, number_reps, trials_per_block, order_1_structure, order_2_structure, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h = experiment_variables(win)

### FUNCTION TO CREATE SOME STIMULI ### 

fixation_cross_horizontal, fixation_cross_vertical, training_instructions_one, training_instructions_two, training_instructions_three, training_instructions_four, training_instructions_five, training_instructions_six, training_instructions_seven, training_instructions_eight, training_instructions_nine, training_complete, block_complete, confidence_instructions, high_confidence, low_confidence, vertical_line, line_length, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, circle_radius, cross_size = create_experimental_stimuli(win)

### FUNCTION FOR HEARTBEAT DETECTION ###

def listenforHR_basic(): 
    pport_address_in = 16361 # set to 889 for psychopys lab tests 16377        
    while True:
        signal_in = readParallelTrigger(pport_address_in)
        if signal_in > 63: 
            time_hb_prev = experiment_clock.getTime()
            break
    return time_hb_prev

### FUNCTION FOR MODIFYING THE SAVE FILE ### 

data_path, data_wb, faces_strings, variable_strings, save_file = save_file_modification(subject_id)

### INSTRUCTIONS FUNCTION ### 

instructions(training_instructions_one, training_instructions_two, training_instructions_three, training_instructions_four, training_instructions_five, training_instructions_six, training_instructions_seven, training_instructions_eight, training_instructions_nine, win)

### MAIN EXPERIMENTAL BLOCKS ### 

# 123, 132, 213, 231, 312, 321

if (counterbalance_group == 1) and (order == 1): # experiment blocks run in order of face 1, face 2, face 3

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)

if (counterbalance_group == 1) and (order == 2): # experiment blocks run in order of face 1, face 2, face 3

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 2) and (order == 1): # experiment blocks run in order of face 1, face 3, face 2

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    

if (counterbalance_group == 2) and (order == 2): # experiment blocks run in order of face 1, face 3, face 2

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 3) and (order == 1): # experiment blocks run in order of face 2, face 1, face 3

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 3) and (order == 2): # experiment blocks run in order of face 2, face 1, face 3

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 4) and (order == 1): # experiment blocks run in order of face 2, face 3, face 1

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 4) and (order == 2): # experiment blocks run in order of face 2, face 3, face 1

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 5) and (order == 1): # experiment blocks run in order of face 3, face 1, face 2

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 5) and (order == 2): # experiment blocks run in order of face 3, face 1, face 2

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 6) and (order == 1): # experiment blocks run in order of face 3, face 2, face 1

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
if (counterbalance_group == 6) and (order == 2): # experiment blocks run in order of face 3, face 2, face 1

    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f3_0v_0h, f3_0v_5h, f3_0v_m5h, f3_0v_10h, f3_0v_m10h, f3_0v_15h, f3_0v_m15h, f3_10v_0h, f3_m10v_0h, f3_10v_5h, f3_10v_m5h, f3_m10v_5h, f3_m10v_m5h, f3_10v_10h, f3_10v_m10h, f3_m10v_10h, f3_m10v_m10h, f3_10v_15h, f3_10v_m15h, f3_m10v_15h, f3_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_3', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f2_0v_0h, f2_0v_5h, f2_0v_m5h, f2_0v_10h, f2_0v_m10h, f2_0v_15h, f2_0v_m15h, f2_10v_0h, f2_m10v_0h, f2_10v_5h, f2_10v_m5h, f2_m10v_5h, f2_m10v_m5h, f2_10v_10h, f2_10v_m10h, f2_m10v_10h, f2_m10v_m10h, f2_10v_15h, f2_10v_m15h, f2_m10v_15h, f2_m10v_m15h, 1, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_2', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)

    
    gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list = experiment_block(countdown, fixation_cross_horizontal, fixation_cross_vertical, win, one_frame, number_reps, f1_0v_0h, f1_0v_5h, f1_0v_m5h, f1_0v_10h, f1_0v_m10h, f1_0v_15h, f1_0v_m15h, f1_10v_0h, f1_m10v_0h, f1_10v_5h, f1_10v_m5h, f1_m10v_5h, f1_m10v_m5h, f1_10v_10h, f1_10v_m10h, f1_m10v_10h, f1_m10v_m10h, f1_10v_15h, f1_10v_m15h, f1_m10v_15h, f1_m10v_m15h, 2, order_1_structure, order_2_structure, rep_length, task_order_1, task_order_2, str_0v_0h, str_0v_5h, str_0v_m5h, str_0v_10h, str_0v_m10h, str_0v_15h, str_0v_m15h, str_10v_0h, str_m10v_0h, str_10v_5h, str_10v_m5h, str_m10v_5h, str_m10v_m5h, str_10v_10h, str_10v_m10h, str_m10v_10h, str_m10v_m10h, str_10v_15h, str_10v_m15h, str_m10v_15h, str_m10v_m15h, experiment_clock, pport_address_spike, trigger_code_spike, circle_radius, cross_size, vertical_line, confidence_instructions, high_confidence, low_confidence, num_ticks, line_length, spacing, tick_length)
    save_experimental_block(data_wb, 'face_1', gaze_directions, systole_diastole, perceptual_responses_x, perceptual_responses_y, distances_from_direct, confidence_responses, r_peak_times_lists, predicted_rr_intervals_list, mean_rr_intervals_list, trials_per_block)
    
data_wb.save(save_file)
data_wb.close()

win.close()
core.quit()
        
    
    
  
